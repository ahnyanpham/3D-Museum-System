-- MUSEUM BENNHARONG DATABASE - SCRIPT PART 3
-- Tables: INVOICE, INVOICE_DETAIL

-- =====================================================
-- 13. INVOICE TABLE
-- =====================================================
CREATE TABLE IF NOT EXISTS INVOICE (
    INVOICE_ID INTEGER PRIMARY KEY,
    INVOICE_CODE TEXT UNIQUE NOT NULL,
    USER_ID INTEGER,
    CUSTOMER_ID INTEGER,
    TOTAL_AMOUNT REAL,
    DISCOUNT REAL DEFAULT 0,
    TAX REAL DEFAULT 0,
    FINAL_AMOUNT REAL,
    PAYMENT_METHOD TEXT,
    PAYMENT_STATUS TEXT DEFAULT 'Pending',
    INVOICE_DATE TEXT,
    NOTES TEXT,
    CREATED_AT TEXT DEFAULT CURRENT_TIMESTAMP,
    UPDATED_AT TEXT DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (USER_ID) REFERENCES USER(USER_ID),
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMER(CUSTOMER_ID)
);

INSERT INTO INVOICE VALUES
(1, 'INV2512160001', 3, 3, 50000, 0, 0, 50000, 'Tiền mặt', 'Paid', '2025-12-16', NULL, '2025-12-16 09:40:12', '2025-12-16 09:40:12'),
(2, 'INV2512160002', 3, 5, 60000, 0, 0, 60000, 'Tiền mặt', 'Paid', '2025-12-16', NULL, '2025-12-16 09:44:36', '2025-12-16 09:44:36'),
(3, 'INV2512160003', 3, 1, 240000, 0, 0, 240000, 'Tiền mặt', 'Paid', '2025-12-16', NULL, '2025-12-16 09:46:57', '2025-12-16 09:46:57'),
(4, 'INV2512160004', 3, 2, 60000, 0, 0, 60000, 'Tiền mặt', 'Paid', '2025-12-16', NULL, '2025-12-16 09:51:15', '2025-12-16 09:51:15'),
(5, 'INV2512160005', 3, 4, 30000, 0, 0, 30000, 'Tiền mặt', 'Paid', '2025-12-16', NULL, '2025-12-16 09:56:17', '2025-12-16 09:56:17'),
(6, 'INV2512160006', 3, 2, 60000, 0, 0, 60000, 'Chuyển khoản', 'Paid', '2025-12-16', NULL, '2025-12-16 09:57:16', '2025-12-16 09:57:16'),
(7, 'INV2512160007', 3, 4, 30000, 0, 0, 30000, 'Tiền mặt', 'Paid', '2025-12-16', NULL, '2025-12-16 10:28:31', '2025-12-16 10:28:31'),
(8, 'INV2512160008', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-16', NULL, '2025-12-16 10:29:18', '2025-12-16 10:29:18'),
(9, 'INV2512170001', 3, 3, 50000, 0, 0, 50000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 04:16:00', '2025-12-17 04:16:00'),
(10, 'INV2512170002', 3, 1, 80000, 0, 0, 80000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 04:20:49', '2025-12-17 04:20:49'),
(11, 'INV2512170003', 3, 4, 45000, 0, 0, 45000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 04:24:04', '2025-12-17 04:24:04'),
(12, 'INV2512170004', 3, 2, 20000, 0, 0, 20000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 04:27:34', '2025-12-17 04:27:34'),
(13, 'INV2512170005', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 04:28:07', '2025-12-17 04:28:07'),
(14, 'INV2512170006', 3, 3, 25000, 0, 0, 25000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 04:28:37', '2025-12-17 04:28:37'),
(15, 'INV2512170007', 3, 1, 40000, 0, 0, 40000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 04:28:55', '2025-12-17 04:28:55'),
(16, 'INV2512170008', 3, 5, 30000, 0, 0, 30000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 04:29:07', '2025-12-17 04:29:07'),
(17, 'INV2512170009', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 05:18:54', '2025-12-17 05:18:54'),
(18, 'INV2512170010', 3, 3, 75000, 0, 0, 75000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 10:29:47', '2025-12-17 10:29:47'),
(19, 'INV2512170011', 3, 5, 30000, 0, 0, 30000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 10:30:21', '2025-12-17 10:30:21'),
(20, 'INV2512170012', 3, 4, 15000, 0, 0, 15000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 10:36:53', '2025-12-17 10:36:53'),
(21, 'INV2512170013', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 10:37:03', '2025-12-17 10:37:03'),
(22, 'INV2512170014', 3, 4, 15000, 0, 0, 15000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 10:38:06', '2025-12-17 10:38:06'),
(23, 'INV2512170015', 3, 1, 40000, 0, 0, 40000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 10:38:16', '2025-12-17 10:38:16'),
(24, 'INV2512170016', 3, 4, 15000, 0, 0, 15000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 10:39:21', '2025-12-17 10:39:21'),
(25, 'INV2512170017', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 10:39:29', '2025-12-17 10:39:29'),
(26, 'INV2512170018', 3, 3, 50000, 0, 0, 50000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 12:42:58', '2025-12-17 12:42:58'),
(27, 'INV2512170019', 3, 3, 25000, 0, 0, 25000, 'Tiền mặt', 'Paid', '2025-12-17', NULL, '2025-12-17 12:48:11', '2025-12-17 12:48:11'),
(28, 'INV2512170020', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-17', NULL, '2025-12-17 12:48:24', '2025-12-17 12:48:24'),
(29, 'INV2512180001', 3, 5, 30000, 0, 0, 30000, 'Tiền mặt', 'Paid', '2025-12-18', NULL, '2025-12-18 00:35:30', '2025-12-18 00:35:30'),
(30, 'INV2512180002', 3, 2, 20000, 0, 0, 20000, 'Tiền mặt', 'Paid', '2025-12-18', NULL, '2025-12-18 02:09:21', '2025-12-18 02:09:21'),
(31, 'INV2512180003', 3, 5, 30000, 0, 0, 30000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 02:10:16', '2025-12-18 02:10:16'),
(32, 'INV2512180004', 3, 3, 25000, 0, 0, 25000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 02:13:28', '2025-12-18 02:13:28'),
(33, 'INV2512180005', 3, 4, 15000, 0, 0, 15000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 02:13:54', '2025-12-18 02:13:54'),
(34, 'INV2512180006', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 02:24:37', '2025-12-18 02:24:37'),
(35, 'INV2512180007', 3, 3, 25000, 0, 0, 25000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 04:19:28', '2025-12-18 04:19:28'),
(36, 'INV2512180008', 3, 1, 40000, 0, 0, 40000, 'Tiền mặt', 'Paid', '2025-12-18', NULL, '2025-12-18 04:38:27', '2025-12-18 04:38:27'),
(37, 'INV2512180009', 3, 4, 15000, 0, 0, 15000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 06:20:39', '2025-12-18 06:20:39'),
(38, 'INV2512180010', 3, 3, 25000, 0, 0, 25000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 07:14:29', '2025-12-18 07:14:29'),
(39, 'INV2512180011', 3, 4, 15000, 0, 0, 15000, 'Tiền mặt', 'Paid', '2025-12-18', NULL, '2025-12-18 07:15:51', '2025-12-18 07:15:51'),
(40, 'INV2512180012', 3, 2, 20000, 0, 0, 20000, 'Chuyển khoản', 'Paid', '2025-12-18', NULL, '2025-12-18 09:10:07', '2025-12-18 09:10:07'),
(41, 'INV2512180013', 3, 3, 25000, 0, 0, 25000, 'Tiền mặt', 'Paid', '2025-12-18', NULL, '2025-12-18 13:49:55', '2025-12-18 13:49:55'),
(42, 'INV2512220001', 3, 3, 25000, 0, 0, 25000, 'Chuyển khoản', 'Paid', '2025-12-22', NULL, '2025-12-22 07:42:58', '2025-12-22 07:42:58'),
(43, 'INV2512230001', 3, 3, 25000, 0, 0, 25000, 'Chuyển khoản', 'Paid', '2025-12-23', NULL, '2025-12-23 03:12:39', '2025-12-23 03:12:39'),
(44, 'INV2512250001', 3, 5, 300000, 0, 0, 300000, 'Tiền mặt', 'Paid', '2025-12-25', 'Vé đoàn 10 người', '2025-12-25 10:42:16', '2025-12-25 10:42:16'),
(45, 'INV2512250002', 3, 2, 20000, 0, 0, 20000, 'Tiền mặt', 'Paid', '2025-12-25', NULL, '2025-12-25 11:24:26', '2025-12-25 11:24:26'),
(46, 'INV2512250003', 3, 3, 25000, 0, 0, 25000, 'Chuyển khoản', 'Paid', '2025-12-25', NULL, '2025-12-25 12:26:42', '2025-12-25 12:26:42'),
(47, 'INV2512260001', 3, 3, 25000, 0, 0, 25000, 'Tiền mặt', 'Paid', '2025-12-26', NULL, '2025-12-26 11:52:03', '2025-12-26 11:52:03');

-- =====================================================
-- 14. INVOICE_DETAIL TABLE
-- =====================================================
CREATE TABLE IF NOT EXISTS INVOICE_DETAIL (
    INVOICE_DETAIL_ID INTEGER PRIMARY KEY,
    INVOICE_ID INTEGER,
    TICKET_ID INTEGER,
    QUANTITY INTEGER DEFAULT 1,
    UNIT_PRICE REAL,
    SUBTOTAL REAL,
    NOTES TEXT,
    FOREIGN KEY (INVOICE_ID) REFERENCES INVOICE(INVOICE_ID),
    FOREIGN KEY (TICKET_ID) REFERENCES TICKET(TICKET_ID)
);

INSERT INTO INVOICE_DETAIL VALUES
(1, 1, 1, 1, 15000, 15000, 'Vé người cao tuổi'),
(2, 1, 2, 1, 15000, 15000, 'Vé người cao tuổi'),
(3, 1, 9, 1, 20000, 20000, 'Vé trẻ em'),
(4, 2, 3, 2, 30000, 60000, 'Vé sinh viên x2'),
(5, 3, 4, 3, 40000, 120000, 'Vé trẻ em x3'),
(6, 3, 5, 3, 40000, 120000, 'Vé trẻ em x3'),
(7, 4, 6, 3, 20000, 60000, 'Vé người lớn x3'),
(8, 5, 7, 1, 15000, 15000, 'Vé trẻ em'),
(9, 5, 8, 1, 15000, 15000, 'Vé trẻ em'),
(10, 6, 9, 1, 20000, 20000, 'Vé trẻ em'),
(11, 6, 10, 1, 20000, 20000, 'Vé trẻ em'),
(12, 6, 11, 1, 20000, 20000, 'Vé trẻ em'),
(13, 7, 12, 2, 15000, 30000, 'Vé trẻ em x2'),
(14, 8, 13, 1, 20000, 20000, 'Vé trẻ em'),
(15, 9, 14, 1, 25000, 25000, 'Vé sinh viên'),
(16, 9, 15, 1, 25000, 25000, 'Vé sinh viên'),
(17, 10, 16, 1, 40000, 40000, 'Vé người lớn'),
(18, 10, 17, 1, 40000, 40000, 'Vé người lớn'),
(19, 11, 18, 1, 15000, 15000, 'Vé người cao tuổi'),
(20, 11, 19, 1, 15000, 15000, 'Vé người cao tuổi'),
(21, 11, 20, 1, 15000, 15000, 'Vé người cao tuổi'),
(22, 12, 21, 1, 20000, 20000, 'Vé trẻ em'),
(23, 13, 22, 1, 20000, 20000, 'Vé trẻ em'),
(24, 14, 23, 1, 25000, 25000, 'Vé sinh viên'),
(25, 15, 24, 1, 40000, 40000, 'Vé người lớn'),
(26, 16, 25, 1, 30000, 30000, 'Vé đoàn thể'),
(27, 17, 26, 1, 20000, 20000, 'Vé trẻ em'),
(28, 18, 27, 1, 25000, 25000, 'Vé sinh viên'),
(29, 18, 28, 1, 25000, 25000, 'Vé sinh viên'),
(30, 18, 38, 1, 25000, 25000, 'Vé sinh viên'),
(31, 19, 29, 1, 30000, 30000, 'Vé đoàn thể'),
(32, 20, 30, 1, 15000, 15000, 'Vé người cao tuổi'),
(33, 21, 31, 1, 20000, 20000, 'Vé trẻ em'),
(34, 22, 32, 1, 15000, 15000, 'Vé người cao tuổi'),
(35, 23, 33, 1, 40000, 40000, 'Vé người lớn'),
(36, 24, 34, 1, 15000, 15000, 'Vé người cao tuổi'),
(37, 25, 35, 1, 20000, 20000, 'Vé trẻ em'),
(38, 26, 36, 1, 25000, 25000, 'Vé sinh viên'),
(39, 26, 37, 1, 25000, 25000, 'Vé sinh viên'),
(40, 27, 38, 1, 25000, 25000, 'Vé sinh viên'),
(41, 28, 39, 1, 20000, 20000, 'Vé trẻ em'),
(42, 29, 40, 1, 30000, 30000, 'Vé đoàn thể'),
(43, 30, 41, 1, 20000, 20000, 'Vé trẻ em'),
(44, 31, 42, 1, 30000, 30000, 'Vé đoàn thể'),
(45, 32, 43, 1, 25000, 25000, 'Vé sinh viên'),
(46, 33, 44, 1, 15000, 15000, 'Vé người cao tuổi'),
(47, 34, 45, 1, 20000, 20000, 'Vé trẻ em'),
(48, 35, 46, 1, 25000, 25000, 'Vé sinh viên'),
(49, 36, 47, 1, 40000, 40000, 'Vé người lớn'),
(50, 37, 48, 1, 15000, 15000, 'Vé người cao tuổi'),
(51, 38, 49, 1, 25000, 25000, 'Vé sinh viên'),
(52, 39, 50, 1, 15000, 15000, 'Vé người cao tuổi'),
(53, 40, 51, 1, 20000, 20000, 'Vé trẻ em'),
(54, 41, 52, 1, 25000, 25000, 'Vé sinh viên'),
(55, 42, 53, 1, 25000, 25000, 'Vé sinh viên'),
(56, 43, 54, 1, 25000, 25000, 'Vé sinh viên'),
(57, 44, 55, 10, 30000, 300000, 'Vé đoàn thể x10'),
(58, 45, 56, 1, 20000, 20000, 'Vé trẻ em'),
(59, 46, 57, 1, 25000, 25000, 'Vé sinh viên'),
(60, 47, 58, 1, 25000, 25000, 'Vé sinh viên');
